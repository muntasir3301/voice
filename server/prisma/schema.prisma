datasource db {
  provider = "postgresql"
  url      =  env("DB_URI")
}

generator client {
  provider = "prisma-client-js"
}

enum UserRole{
    user
    admin
    super_admin
}

model User{
  id       Int      @id @default(autoincrement())
  role     UserRole   @default(user)
  ref_code    Int
  username String   @unique
  password String

  profile UserProfile?
  adminProfile AdminProfile?
  voiceData VoiceData[]
}

model UserProfile{
  id   Int   @id @default(autoincrement())
  user_id Int @unique
  city String
  age Int
  sentence_id Int   @default(1)
  total    Int      @default(0)
  accept    Int     @default(0)

  user User @relation(fields: [user_id], references: [id])
}

model AdminProfile{
    id Int @id @default(autoincrement())
    user_id Int @unique
    name String
    email String
    address String
    phone String
    age Int
    university String
    total    Int     @default(0)
    accept    Int     @default(0)

    user User @relation(fields: [user_id], references: [id])
}

model SuperAdminProfile{
    id Int @id @default(autoincrement())
    user_id Int @unique
    name String
    total    Int     @default(0)
    accept    Int     @default(0)
}

model Sentence{
  id Int @id @default(autoincrement())
  text String
  count Int @default(0)
  usedBy Int[] @default([])

  voiceData VoiceData[]
}

model Voice{
  id Int @id @default(autoincrement())
  record Bytes
}


model VoiceData{
  id Int @id @default(autoincrement())
  user_id Int
  sentence_id Int
  voice_id Int @unique
  length Int
  status Boolean @default(false)
  ref_code Int
  
  user User @relation(fields: [user_id], references: [id])
  sentence Sentence @relation(fields: [sentence_id], references: [id])
}

// User 
// {
//     "role": "admin",
//     "age" : 22,
//     username: "johfa",
//     password: "1234jf"
// }